# 🚀 V7实盘交易 - 快速开始

## 当前状况

✅ **V7模型**：已训练完成（`ppo_stock_v7.zip`）  
✅ **交易脚本**：已创建（`realtime_trading_v7.py`）  
⚠️ **数据日期**：最新到 **2024-12-31**

---

## 📊 三种使用场景

### 场景1：基于现有数据生成信号（推荐）

**适用**：学习、验证策略、历史回测

```bash
# 使用2024-12-31的数据
python realtime_trading_v7.py --date 2024-12-31
```

**输出示例**：
```
目标日期: 2024-12-31
个股交易信号：
📊 招商银行: 买入25%可用资金
📊 中国平安: 持有
📊 五粮液: 卖出50%持仓
...
```

---

### 场景2：更新数据后生成实时信号

**适用**：真实交易前一天

#### 步骤1：更新数据

```bash
python update_realtime_data.py
```

这将：
- 从baostock获取2025年的最新数据
- 合并到现有数据文件
- 保存到 `stockdata_v7_realtime/`

#### 步骤2：修改交易脚本路径

编辑 `realtime_trading_v7.py`，修改数据目录：

```python
# 第49行附近
possible_paths = [
    f"stockdata_v7_realtime/{stock_code}.{stock_name}.csv",  # 新增：实时数据
    f"stockdata_v7/train/{stock_code}.{stock_name}.csv",
    f"stockdata_v7/test/{stock_code}.{stock_name}.csv",
]
```

#### 步骤3：生成最新信号

```bash
python realtime_trading_v7.py --date 2025-11-26
```

---

### 场景3：每日自动化（高级）

创建定时任务，每天收盘后自动生成交易信号。

#### Windows任务计划

```batch
# 创建批处理文件: daily_signal.bat
@echo off
cd E:\wangshub\RL-Stock
call venv\Scripts\activate.bat
python update_realtime_data.py
python realtime_trading_v7.py --date %date:~0,10% > 交易信号_%date:~0,10%.txt
```

#### Linux Cron

```bash
# 每天18:00运行
0 18 * * * cd /path/to/RL-Stock && source venv/bin/activate && python realtime_trading_v7.py > signal_$(date +\%Y\%m\%d).txt
```

---

## 🎯 立即测试（使用现有数据）

### 命令1：查看2024年底的交易信号

```bash
python realtime_trading_v7.py --date 2024-12-31
```

### 命令2：自动使用最新数据

```bash
python realtime_trading_v7.py
```

### 命令3：保存到文件

```bash
python realtime_trading_v7.py --date 2024-12-31 > 交易信号_20241231.txt
```

---

## 📈 输出内容说明

### 个股信号

```
📊 招商银行 (sh.600036)
   日期: 2024-12-31
   当前价格: ¥35.20          # 收盘价
   涨跌幅: +1.23%             # 当日涨跌
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   💼 持仓情况:
      持仓比例: 65.0%         # 模型当前持仓占比
      持股数量: 1,800 股      # 持有股数
      持股市值: ¥63,360       # 持仓市值
      现金余额: ¥35,000       # 可用现金
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   🟢 低风险 (风险评分: 2/6)  # V7风险评估
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ⚡ 交易建议: 买入25%可用资金
      → 买入约 200 股         # 具体买入股数
      → 预计花费 ¥7,040      # 预计花费金额
```

### 风险等级

| 符号 | 等级 | 评分 | 操作建议 |
|------|------|------|----------|
| 🟢 | 低风险 | 0-1 | 可积极操作 |
| 🟡 | 中等风险 | 2-3 | 正常操作 |
| 🔴 | 高风险 | 4-6 | 谨慎操作，考虑减仓 |

### 投资组合汇总

```
当前总资产: ¥110,570
累计收益: ¥10,570 (+10.57%)  # 基于10万本金

交易信号分布:
  买入信号: 3 只
  卖出信号: 1 只
  持有信号: 2 只
```

---

## ⚠️ 重要提示

### 数据时效性

| 数据日期 | 适用场景 |
|---------|---------|
| **当天数据** | ✅ 真实交易（最理想） |
| **前一交易日** | ⚠️ 需警惕隔夜风险 |
| **1-2周前** | ❌ 仅供参考，不建议实盘 |
| **1个月以上** | ❌ 仅用于策略验证 |

### 您的情况

```
数据最新日期: 2024-12-31
当前日期: 2025-11-25
时间差: 约11个月 ⚠️

建议操作:
1. ✅ 用于学习和理解系统
2. ✅ 验证V7策略逻辑
3. ❌ 不建议直接用于实盘交易
4. 📅 如需实盘，先更新数据到2025-11
```

---

## 🔄 数据更新步骤（实盘前必做）

### 方法1：使用baostock（免费）

```bash
# 运行数据更新脚本
python update_realtime_data.py
```

**注意**：baostock可能有1-2天延迟

### 方法2：使用Tushare（需积分）

如果有Tushare账号：

```python
# 修改 update_realtime_data.py 使用Tushare
import tushare as ts
ts.set_token('your_token')
pro = ts.pro_api()

df = pro.daily(
    ts_code='600036.SH',
    start_date='20250101',
    end_date='20251126'
)
```

### 方法3：手动下载

1. 从券商软件导出数据
2. 转换为CSV格式
3. 保存到 `stockdata_v7_realtime/`

---

## 📊 验证数据质量

```bash
# 检查数据文件最后日期
python -c "import pandas as pd; df=pd.read_csv('stockdata_v7/test/sh.600036.招商银行.csv'); print(f'最新日期: {df.date.max()}')"
```

---

## 🆘 常见问题

### Q: 为什么显示"未找到数据"？

**A**: 数据日期不足，解决方法：
```bash
# 选项1：使用现有最新日期
python realtime_trading_v7.py

# 选项2：更新数据后重试
python update_realtime_data.py
python realtime_trading_v7.py --date 2025-11-26
```

### Q: 信号准确吗？

**A**: 信号基于：
- ✅ V7模型（历史回测+10.57%）
- ✅ 技术指标（MA、RSI、MACD等）
- ✅ 风险控制（回撤、波动率）
- ⚠️ 但无法预测突发事件

**建议**：结合实时新闻、政策、基本面判断

### Q: 能保证盈利吗？

**A**: ❌ **不能**
- 历史收益不代表未来
- 模型基于2024年前数据训练
- 市场环境可能变化
- 仅供参考，风险自负

---

## 📞 下一步

### 现在就试试（使用历史数据）

```bash
# 方法1：指定日期
python realtime_trading_v7.py --date 2024-12-31

# 方法2：自动最新
python realtime_trading_v7.py

# 方法3：保存结果
python realtime_trading_v7.py > 测试信号.txt
```

### 准备实盘交易

1. ✅ 熟悉系统输出
2. 📊 更新数据到最新
3. 🧪 模拟交易1-2周
4. 💰 小资金实盘测试
5. 📈 逐步增加仓位

---

**祝交易顺利！** 🚀

如有问题，参考：`实盘交易指南_V7.md`

