# V7 实盘交易指南

## 🎯 概述

本指南帮助您使用训练好的V7模型进行实盘交易决策。

---

## 📋 使用方法

### 1. 生成2025年11月26日的交易信号

```bash
python realtime_trading_v7.py --date 2025-11-26
```

### 2. 使用最新数据生成交易信号

```bash
python realtime_trading_v7.py
```

### 3. 指定自定义模型

```bash
python realtime_trading_v7.py --model ppo_stock_v7.zip --date 2025-11-26
```

---

## 📊 输出报告内容

### 个股信号示例

```
📊 招商银行 (sh.600036)
   日期: 2025-11-26
   当前价格: ¥35.20
   涨跌幅: +1.23%
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   💼 持仓情况:
      持仓比例: 65.0%
      持股数量: 1,800 股
      持股市值: ¥63,360
      现金余额: ¥35,000
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   🟢 低风险 (风险评分: 2/6)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ⚡ 交易建议: 买入25%可用资金
      → 买入约 200 股
      → 预计花费 ¥7,040
```

### 投资组合汇总

```
当前总资产: ¥110,570
累计收益: ¥10,570 (+10.57%)

交易信号分布:
  买入信号: 3 只
  卖出信号: 1 只
  持有信号: 2 只
```

---

## 🔧 前置条件

### 1. 确保有最新数据

数据文件路径（按优先级）：
```
stockdata_v7/train/{股票代码}.{股票名称}.csv
stockdata_v7/test/{股票代码}.{股票名称}.csv
stockdata/{股票代码}.{股票名称}.csv
```

### 2. 确保有V7模型

```bash
# 检查模型是否存在
ls ppo_stock_v7.zip
```

如果不存在，运行：
```bash
python train_v7.py
```

---

## 📈 实盘操作流程

### 第1步：获取交易信号（前一交易日晚上）

```bash
# 生成明天（2025-11-26）的交易信号
python realtime_trading_v7.py --date 2025-11-26 > 交易信号_20251126.txt
```

### 第2步：人工审核

查看生成的交易信号，重点检查：

1. **风险等级**：
   - 🔴 高风险：谨慎操作，减少仓位
   - 🟡 中等风险：正常操作
   - 🟢 低风险：可积极操作

2. **持仓比例**：
   - 已重仓（>70%）→ 谨慎加仓
   - 中等仓位（30-70%）→ 灵活操作
   - 轻仓（<30%）→ 可加仓

3. **交易合理性**：
   - 结合当日新闻、政策
   - 检查技术面（K线、均线）
   - 确认基本面无重大变化

### 第3步：执行交易（当日开盘后）

#### 买入操作

```
建议：买入25%可用资金
↓
实际操作：
1. 计算买入金额 = 现金余额 × 25%
2. 计算买入股数 = 买入金额 / 当前价格
3. 股数取整到100的倍数
4. 下单买入
```

#### 卖出操作

```
建议：卖出50%持仓
↓
实际操作：
1. 计算卖出股数 = 当前持股 × 50%
2. 股数取整到100的倍数
3. 下单卖出
```

### 第4步：记录执行

创建交易日志：

```csv
日期,股票,建议,实际执行,价格,股数,金额,备注
2025-11-26,招商银行,买入25%,已执行,35.20,200,7040,符合策略
2025-11-26,五粮液,卖出50%,部分执行,158.30,400,63320,流动性受限
```

---

## ⚠️ 重要注意事项

### 1. 交易成本

模型训练时的成本设置：
```python
commission_rate=0.00025      # 佣金费率 0.025%
min_commission=5             # 最低佣金 5元
stamp_duty_rate=0.0005       # 印花税 0.05%（仅卖出）
slippage_rate=0.001          # 滑点 0.1%
```

**实际交易时**，您的券商费率可能不同，需要调整预期收益。

### 2. 资金分配

模型假设：
- 初始资金：100,000元
- 平均每只股票：16,667元

**实际操作**：
- 按比例放大/缩小
- 例如：50万资金 = 5倍模型建议

### 3. 风险控制

#### 单日最大亏损

```python
如果 单日亏损 > 3%:
    停止所有买入操作
    考虑减仓

如果 单日亏损 > 5%:
    强制止损
    暂停交易
```

#### 持仓集中度

```python
单只股票持仓 < 25%  # 避免过度集中
现金比例 > 10%      # 保持流动性
```

---

## 📊 性能追踪

### 创建交易记录表

```python
# 每日更新
import pandas as pd

trade_log = pd.DataFrame({
    'date': [],
    'portfolio_value': [],
    'daily_return': [],
    'cumulative_return': [],
    'trades_executed': []
})
```

### 与模型对比

```python
模型回测收益率: +10.57%
实盘收益率: ?

差异原因分析:
1. 交易成本差异
2. 滑点影响
3. 执行时机
4. 市场环境变化
```

---

## 🔄 定期更新

### 每周任务

1. **更新数据**：
   ```bash
   python get_stock_data_v7.py  # 获取最新一周数据
   ```

2. **验证信号**：
   ```bash
   python realtime_trading_v7.py  # 生成新信号
   ```

### 每月任务

1. **重新训练**（可选）：
   ```bash
   python train_v7.py  # 用最新数据重新训练
   ```

2. **性能评估**：
   ```bash
   python evaluate_v7.py  # 评估模型表现
   ```

---

## 🆘 常见问题

### Q1: 信号与实际市场不符？

**原因**：模型基于历史数据训练，无法预测突发事件

**解决**：
- 结合实时新闻
- 关注重大政策
- 突发事件时暂停自动交易

### Q2: 买入后立即下跌？

**原因**：
- 模型延迟（基于历史数据）
- 市场波动
- 滑点影响

**解决**：
- 设置止损位（-3%）
- 分批买入（降低风险）
- 复盘分析原因

### Q3: 交易频率太高？

**原因**：V7基于技术指标，可能频繁交易

**解决方法**：
```python
# 设置交易间隔
最小持仓天数 = 3天  # 买入后至少持有3天
```

### Q4: 如何处理停牌？

```python
if 股票停牌:
    跳过该股票
    信号延后到复牌日
    # 在realtime_trading_v7.py中手动检查
```

---

## 📞 支持

如有问题，请检查：
1. 数据文件是否最新
2. 模型文件是否完整
3. Python环境是否正确

---

## 📄 免责声明

⚠️ **重要提示**：

1. 本系统基于AI模型，**不构成投资建议**
2. 历史业绩不代表未来收益
3. 股市有风险，投资需谨慎
4. 请根据自身风险承受能力决策
5. 建议咨询专业投资顾问

---

**祝交易顺利！** 📈

