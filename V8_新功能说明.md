# V8 版本新功能说明

## 📋 概述

V8版本新增了以下功能：
1. **技术指标计算模块** - 支持KDJ、OBV、RSI、MACD等多种指标，参数可配置
2. **多数据源组合管理** - 支持Tushare、AkShare、baostock等多个数据源的自动切换和容错
3. **LLM指标解释模块** - 基于大语言模型的智能指标解释

## 🔧 技术指标模块

### 功能特性

- **KDJ指标**：支持可配置的周期参数（默认9,3,3）
- **OBV指标**：能量潮指标，支持平滑周期配置
- **RSI指标**：相对强弱指标，支持周期配置（默认14）
- **MACD指标**：支持快线、慢线、信号线参数配置
- **移动平均线**：支持多周期MA（默认5,10,20,60）

### 参数配置

在 `real_time_predict_v7_600730.py` 中，可以通过 `TECHNICAL_INDICATOR_CONFIG` 字典调整参数：

```python
TECHNICAL_INDICATOR_CONFIG = {
    'kdj_period': 9,           # KDJ周期（默认9）
    'kdj_slow_period': 3,      # KDJ慢速平滑周期（默认3）
    'kdj_fast_period': 3,      # KDJ快速平滑周期（默认3）
    'rsi_period': 14,          # RSI周期（默认14）
    'macd_fast': 12,           # MACD快线周期（默认12）
    'macd_slow': 26,           # MACD慢线周期（默认26）
    'macd_signal': 9,          # MACD信号线周期（默认9）
    'obv_smooth_period': 20,   # OBV平滑周期（默认20）
    'ma_periods': [5, 10, 20, 60]  # 移动平均线周期列表
}
```

### 使用方法

技术指标计算器会自动在实时预测循环中运行，计算所有指标并显示摘要。

## 🌐 多数据源管理模块

### 功能特性

- **自动检测**：自动检测可用的数据源（Tushare、AkShare、baostock）
- **优先级管理**：可配置数据源优先级（默认：tushare > akshare > baostock）
- **容错切换**：一个数据源失败时自动切换到下一个
- **统计监控**：记录每个数据源的成功/失败次数

### 使用方法

多数据源管理器会自动初始化并在数据获取时使用。如果某个数据源失败，会自动切换到下一个可用数据源。

### 配置

```python
multi_source_manager = MultiDataSourceManager(
    stock_code=STOCK_CODE,
    timeout=10,        # 请求超时时间（秒）
    retry_times=3      # 重试次数
)
```

## 🤖 LLM指标解释模块

### 功能特性

- **智能解释**：使用LLM对技术指标进行专业解释
- **多维度分析**：分析KDJ、RSI、OBV、MACD等多个指标
- **交易建议**：根据技术指标综合给出交易建议
- **缓存支持**：支持缓存解释结果，减少API调用

### 使用方法

LLM指标解释器需要LLM代理支持（如MarketIntelligenceAgent）。如果LLM未启用，会使用基础解释功能。

### 解释内容

- KDJ指标分析：超买/超卖判断、金叉死叉信号
- RSI指标分析：强弱判断、超买超卖区域
- OBV指标分析：成交量趋势、资金流向
- MACD指标分析：趋势判断、动能分析
- 综合信号：综合各指标给出整体信号（看涨/看跌/中性）
- 交易建议：具体的交易操作建议

## 📊 使用示例

### 查看技术指标

运行实时预测脚本后，会自动显示技术指标分析：

```
   📊 技术指标分析（KDJ、OBV、RSI、MACD等）
   ================================================================
   📈 KDJ指标: K=65.32, D=58.45, J=78.95
   📉 RSI指标: 62.34
   💰 OBV指标: 比率=1.15
   📊 MACD指标: DIF=0.0234, DEA=0.0156, MACD=0.0156
   📈 MA5: 12.45
   📈 MA10: 12.38
   📈 MA20: 12.25
   📈 MA60: 12.10
   ================================================================
```

### 查看LLM解释

如果启用了LLM解释，会显示详细的智能分析：

```
   🤖 技术指标智能解释
   ================================================================
   📊 KDJ指标:
      K=65.32, D=58.45, J=78.95
      信号: 看涨
      说明: K线上穿D线，形成看涨信号
   📈 RSI指标:
      值: 62.34
      信号: 偏强
      说明: RSI=62.34，处于强势区域
   ...
   🟢 综合信号: 看涨
   💡 交易建议: 技术指标综合显示看涨信号，可考虑买入或加仓
   ================================================================
```

## 🔄 模块依赖

### 必需依赖

- `pandas`：数据处理
- `numpy`：数值计算

### 可选依赖

- `tushare`：Tushare数据源
- `akshare`：AkShare数据源
- `baostock`：baostock数据源
- `llm_market_intelligence`：LLM代理支持

## 📝 注意事项

1. **技术指标计算**：需要足够的历史数据才能准确计算指标。建议至少提供20-30个数据点。
2. **数据源切换**：多数据源管理器会在数据源失败时自动切换，无需手动干预。
3. **LLM解释**：需要配置LLM API密钥才能使用LLM解释功能。如果没有配置，会使用基础解释。
4. **参数调整**：调整技术指标参数时，建议根据股票特性进行优化，不同股票可能需要不同的参数设置。

## 🚀 后续优化方向

1. 支持更多技术指标（布林带、CCI、ADX等）
2. 支持自定义指标公式
3. 多数据源数据合并策略优化
4. LLM解释结果的可视化
5. 指标参数的自动优化

